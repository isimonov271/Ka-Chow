<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Фильтр оборудования</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
    th { background: #eee; }
  </style>
  <!-- подключаем PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <h2>Оборудование — фильтр по статусу</h2>
  <label for="statusFilter">Статус: </label>
  <select id="statusFilter">
    <option value="Все">Все</option>
    <option value="Занято">Занято</option>
    <option value="Свободно">Свободно</option>
  </select>

  <table id="equipTable">
    <thead>
      <tr>
        <th>Тип</th><th>Описание</th><th>Стоимость</th><th>Кол-во</th>
        <th>В работе</th><th>Занято по иным причинам</th>
        <th>Свободно</th><th>Статус</th><th>Комментарий</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQsJ4e0JCUNHSH6Ff2OVf6igWCTG1srsFOK3Y-3vcxCQ32sjd86k9z1Af7WGZLfK1aYQXmeMomUo6PK/pub?output=csv";

let allData = [];

// Загружаем CSV через PapaParse
Papa.parse(url, {
  download: true,
  header: false,
  complete: function(results) {
    allData = results.data.slice(1); // пропускаем заголовок
    renderTable("Все");
  }
});

function renderTable(filter) {
  const tbody = document.querySelector("#equipTable tbody");
  tbody.innerHTML = "";

  allData.forEach(row => {
    const status = row[7]?.trim(); // колонка H (8-я колонка, индекс 7)
    if (filter === "Все" || status === filter) {
      const tr = document.createElement("tr");
      row.forEach(cell => {
        const td = document.createElement("td");
        td.textContent = cell;
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    }
  });
}

document.getElementById("statusFilter").addEventListener("change", e => {
  renderTable(e.target.value);
});
</script>
</body>
</html>
